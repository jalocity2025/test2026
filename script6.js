const questions = [
    {
        "q": "الامر الذي يجعل زر الأوامر يظهر بلون باهت ولا يستجيب للنقر هو",
        "options": [
            "Comand1.Enabled = False",
            "Comand1.Visible = False",
            "Comand1.Locked = False"
        ],
        "answer": 0
    },
    {
        "q": "يتم الفصل بين الاداة و الحدث باستخدام  النقطة",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يتم كتابة الخوارزمية باستخدام لغة البيسك المرئي",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يمكن ضبط خصائص الأداة باستخدام نافذة الخصائص اثناء تنفيذ البرنامج",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "جميعها احداث  للفارة عدا",
        "options": ["mouseup", "keypress", "mousedown", "click"],
        "answer": 1
    },
    {
        "q": "عند وجود اكثر من نموذج يستخدم البيسك المرئي اول نموذج كنموذج بدء التشغيل",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "تعتبر لغة فيجول بيسك من اللغات ذات تصميم مرئي و واجهة رسومية.(GUI)",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "   الخاصية Text  خاصية مشتركة بين جميع الادوات",
        "options": ["صح", "خطأ", "لا شئ مما ذكر"],
        "answer": 1
    },
    {
        "q": "الخاصية المسئولة على اظهار او إخفاء الأداة هى",
        "options": ["show", "caption", "text", "visible", "لا شئ مما ذكر"],
        "answer": 3
    },
    {
        "q": "لاخفاء النموذج نستخدم الامر",
        "options": ["form1.Hide", "form1.move", "Form1.show", "form1.cls", "لا شئ مما ذكر"],
        "answer": 0
    },
    {
        "q": "لمسح ما هو مطبوع على النموذج نستخدم الطريقة",
        "options": ["Cls", "Form1.cls", "Me.cls", "جميع ما سبق"],
        "answer": 3
    },
 {
        "q": " فى محرر الكود اذا كتب اسم الاداة صحيحا ثم  تطبع النقطة يتم عرض قائمة بالخصائص و الوظائف و الاحداث",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "هو debug      الامر الذي يقوم بتنفيذ سطر سابق من قائمة",
        "options": ["step into", "step over", "step out", "break point"],
        "answer": 2
    },
    {
        "q": "كتابة الخوارزمية يتم فيها تحديد الأدوات المطلوبة",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "الخطأ المنطقي يتم اكتشافه بواسطة",
        "options": ["مترجم لغة البيسك المرئي", "المستخدم", "لا شئ مما ذكر"],
        "answer": 1
    },
    {
        "q": "عندما نقوم بوضع اداة على النموذج يقوم البيسك المرئي بتسميتها تلقائيا",
        "options": ["صح", "خطأ", "لا شئ مما ذكر"],
        "answer": 0
    },
    {
        "q": "يعتبر تنفيذ الحل  باستخدام لغة البيسك المرئي  اهم جزء فى حل المشاكل البرمجية",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "عند وجود اكثر من نموذج يستخدم البيسك المرئي اخر نموذج كنموذج بدء التشغيل",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "لاظهار النموذج نستخدم الطريقة hide",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
{
        "q": "حدث تمرير مؤشر الفارة فوق زر الامر",
        "options": ["MouseUp", "MouseOver", "MouseDown", "DragOver"],
        "answer": 1
    },
{
 "q": "تسمح بظهور الصورة المضافة  لاداة زر الامر اذا كنت قيمتها 1Graphical ",
        "options": ["BackStyle", "Style", "لا شئ مما ذكر"],
        "answer": 1
    },
{
 "q": "من الطرق",
        "options": ["SetFocus", "LostFocus", "GotFocus"],
        "answer": 0
    },
 {
        "q": "يشترط فى استخدام الطريقة SetFocus ان تكون الاداة ظاهرة و فعالة",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
{
 "q": "تسمح بظهور اللون لاداة العنوان  اذا كنت قيمتها 0-transparent ",
        "options": ["Style", "BackStyle", "لا شئ مما ذكر"],
        "answer": 1
    },
{
 "q": "الامر المستخدم لتخزين المشروع هو ",
        "options": ["Open Project", "Save Project", "New Project"],
        "answer": 1
    },
{
 "q": "تسمح بظهور اللون لاداة زر الامر اذا كنت قيمتها 1Graphical ",
        "options": ["Style", "BackStyle", "لا شئ مما ذكر"],
        "answer": 0
    },
    {
        "q": "القيمة الافتراضية للون خلفية النموذج (BackColor) هي اللون الرصاصي",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "القيمة الافتراضية للخاصية (BackStyle) للاداة العنوان هى معتم ",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمكن للمستخدم تغيير النص الموجود داخل أداة العنوان (Label) مباشرة أثناء التشغيل بالنقر داخله.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يتم الفصل بين الاداة و الخاصية باستخدام الشرطة التحتية",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يتم الفصل بين الاداة و الخاصية باستخدام  النقطة",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "الخاصية  Name مشتركة بين جميع الادوات",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "الامر الذى يجعل صندوق النص مثل اداة العنوان هو",
        "options": ["text1.locked = true", "text1.enabled = true", "text1.multiline = true", "text1.text = true"],
        "answer": 0
    },
    {
        "q": "الطريقة المستخدمة مع الحدث     Load",
        "options": ["Move", "Show", "cls", "Setfocus"],
        "answer": 1
    },
    {
        "q": "إخفاء او اظهار  زر الأمر نستخدم الخاصية",
        "options": ["caption", "text", "visible", "multiline"],
        "answer": 2
    },
    {
        "q": "يفصل بين الأداة و اسم الحدث بـ",
        "options": ["بنقطة", "بالشرطة التحتية", "بالفاصلة", "بالفاصلة المنقوطة"],
        "answer": 1
    },
    {
        "q": "النافذة التى تستخدم لمعرفة مكان ظهور النموذج عند تنفيذ البرنامج",
        "options": ["Immediate Window النافذة السريعة", "form layout window نافذة شكل النموذج", "form window نافذة النموذج"],
        "answer": 1
    },
    {
        "q": "النافذة التى تستخدم لتغير قيم الخصائص هي",
        "options": ["Immediate Window النافذة السريعة", "form window نافذة النموذج", "Properties window نافذة اخصائص", "form layout window نافذة شكل النموذج"],
        "answer": 2
    },
    {
        "q": "الخطأ فى البرنامج التالي هو خطأ \n <div class='code-block'>Private Sub Form_Load()\n   Command1.Cabtion = true\nEnd Sub</div>",
        "options": ["منطقي", "لغوي"],
        "answer": 1
    },
    {
        "q": "النافذة التى تستخدم لمعرفة مكونات ملف المشروع",
        "options": ["project explorer Window نافذة مستكشف المشروع", "form window نافذة النموذج", "Properties window نافذة اخصائص", "form layout window نافذة شكل النموذج"],
        "answer": 0
    },
    {
        "q": "النافذة التى تستخدم للتبديل بين نافذة النموذج و صفحة محرر الكود هي",
        "options": ["project explorer Window نافذة مستكشف المشروع", "form window نافذة النموذج", "Properties window نافذة اخصائص", "form layout window نافذة شكل النموذج"],
        "answer": 0
    },
    {
        "q": "يمكن اظهار نافذة الخصائص بضغط مفتاح",
        "options": ["F5", "F4", "Ctrl + G"],
        "answer": 1
    },
    {
        "q": "يمكن تنفيذ البرنامج بضغط مفتاح",
        "options": ["F5", "F4", "Ctrl + G"],
        "answer": 0
    },
    {
        "q": "  الحدث Keypress يحدث",
        "options": ["عند عملية ابقاء الضغط على زر الفارة لاسفل", "عند نقل الاداة من مكان لاخر", "عند ضغط احد الحروف على لوحة المفاتيح", "عند انهاء الضغط على زر الفارة"],
        "answer": 2
    },
    {
        "q": "من الاحداث الخاصة بالنموذج و الذي ينفذ تلقائيا عند تحميل النموذج هو",
        "options": ["click", "Load", "mousedown", "show"],
        "answer": 1
    },
    {
        "q": "لرسم دائرة على النموذج نستخدم الطريقة",
        "options": ["Hide", "Cls", "Move", "Circle"],
        "answer": 3
    },
    {
        "q": "   لاضافة عنوان نستخدم الخاصية  caption  وهى من خصائص",
        "options": [" Label", "Command Button", "Form", "جميع الاجابات صحيحة"],
        "answer": 3
    },
    {
        "q": "ما ناتج الامر form1.show",
        "options": ["اظهار النموذج", "اخفاء النموذج"],
        "answer": 0
    },
    {
        "q": "المكان الرئيسي الذي يتم فيه تصميم البرامج و التطبيقات",
        "options": ["Form", "Label", "Command button", "Textbox"],
        "answer": 0
    },
   {
        "q": "الطريقة التى تؤدي الى وضع المؤشر داخل صندوق النص",
        "options": ["SetFocus", "Hide", "Move", "Show"],
        "answer": 0
    },
{
        "q": "اي من الادوات التالية زر امر",
        "options": ["frmWelcome", "lblName", "cmdFinish", "txtname"],
        "answer": 2
    },
    {
        "q": "Print  بدلا  من   Prent  عند كتابة الامر",
        "options": ["النحوية", "المنطقية", "اللغوية", "الاملائية"],
        "answer": 2
    },
{
        "q": "اي من الادوات التالية صندوق نص",
        "options": ["frmWelcome", "lblName", "cmdFinish", "txtname"],
        "answer": 3
    },
{
        "q": "اي من الادوات التالية اداة عنوان",
        "options": ["frmWelcome", "lblName", "cmdFinish", "txtname"],
        "answer": 1
    },
{
 "q": "البرنامج التالي يقوم برسم :\n<div class='code-block'>Private Sub Form_Load()\nMe.ScaleMode = 3\nMe.Line (30, 30)-(100, 100), vbBlue, BF\nEnd Sub</div>",
    "options": ["رسم مستطيل او مربع ", "رسم خط مستقيم فقط", "لا شئ مما ذكر"],
    "answer": 0
},
    {
        "q": "لجعل خلفية أداة العنوان (Label) شفافة، نختار القيمة (0-Transparent) في خاصية",
        "options": ["BackStyle", "BackColor", "Alignment", "لا شئ مما سبق"],
        "answer": 0
    },
    {
        "q": "توفر البيسك المرئي امكانية اضافة البرمجيات الفرعية  لاختيار الامر Add procedure ",
        "options": [ "Project", "Run", "Tools", "File"],
        "answer": 2
    },
    {
        "q": "ما هو  الخطأ  في الجزء البرمجي التالي ؟\n<div class='code-block'>Private sub Form_Load()\nform1-show\nform1.cls\ncommand1.setfocus\nEnd Sub</div>",
        "options": ["command1.setfocus", "form1.cls", "form1-show"],
        "answer": 2
    },
{
        "q": "يمكن اظهار نافذة الخصائص بضغط مفتاح",
        "options": ["F5", "F4", "Ctrl + G"],
        "answer": 1
    },
    {
        "q": "كم عدد طرق  تنفيذ البرنامج فى البيسك المرئي",
        "options": ["2", "3", "1"],
        "answer": 1
    },
 {
        "q": "الامر المستخدم لادخال نص مكون من عدة اسطر داخل صندوق النص هو",
        "options": ["TEXT1.MULTILINE=TRUE", "TEXT1.MULTILINE=\"TRUE\"", "TEXT1.MULTILINE=FALSE", "TEXT1.MULTILINE=\"FALSE\""],
        "answer": 1
  },
    {
        "q": "الخاصية التى تجعل زر الامر فعال او غير فعال  اى لا يقبل الاحداث",
        "options": ["Locked", "Multiline", "Enabled"],
        "answer": 2
    },
    {
        "q": "يجب وضع كود الرسم (مثل Circle أو Line) في حدث Load أو Paint ليظهر بشكل صحيح.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "حدث LostFocus يقع عندما يقوم المستخدم بالنقر على أداة أخرى وترك الأداة الحالية.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
{
 "q": "البرنامج التالي يقوم برسم :\n<div class='code-block'>Private Sub Form_Load()\nMe.ScaleMode = 3\nMe.Line (30, 30)-(100, 100), vbBlue, BF\nEnd Sub</div>",
    "options": ["رسم مستطيل او مربع ", "رسم خط مستقيم فقط", "لا شئ مما ذكر"],
    "answer": 0
},
    {
        "q": "خاصية Alignment في أداة العنوان تستخدم لمحاذاة  الكتابة (يمين، يسار، وسط)",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمكن تنفيذ طريقة SetFocus على أداة اذا تم ضبط خاصية Enabled لها على القيمة (False).",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "حدث Change في صندوق النص ينفذ فقط عند الضغط على مفتاح Enter.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "اي منهم طريقة",
        "options": ["LostFocus", "GotFocus", "SetFocus"],
        "answer": 2
  },
    {
        "q": "عند ضبط خاصية MaxLength في صندوق النص إلى القيمة (0)، فإن ذلك يعني",
        "options": ["طول النص لا نهائي", "لا يمكن الكتابة في الصندوق", "يسمح بكتابة حرف واحد فقط"],
        "answer": 0
    },
    {
        "q": "الخاصية التي تحدد اسم النموذج في \"كود البرنامج\" هي",
        "options": ["Caption", "Name", "Text"],
        "answer": 1
    },
{
    "q": "البرنامج التالي يقوم برسم :\n<div class='code-block'>Private Sub Form_Load()\nMe.ScaleMode = 3\nMe.Circle (150, 150), 40, vbRed\nEnd Sub</div>",
    "options": ["دائرة ", "نصف قطرها 40", "لونها احمر", "جميع الاجابات صحيحةر"],
    "answer": 3
},
 {
        "q": "لجعل خلفية أداة زر الامر  تقبل اضافة لون نختار القيمة (1-Graphical) في خاصية",
        "options": [" Style", "BackColor", "Backstyle", "لا شئ مما سبق"],
        "answer": 0
    },
 {
        "q": "الامر المستخدم للسماح يالتفاف النص اى جعله عدة سطور داخل اداة العنوان  هو",
        "options": ["LABEL1.MULTILINE=TRUE", "TEXT1.MULTILINE= TRUE ", "LABEL1.WORDWRAP=TRUE", "TEXT1.MULTILINE= FALSE "],
        "answer": 2
  },
{
        "q": "اى من الجمل التالية تعين الجملة\"بيانات الطلاب\" كعنوان للنموذج form1",
        "options": ["\" بيانات الطلاب \"=form1.caption ", "\" بيانات الطلاب \"=form1.text", "\" بيانات الطلاب \"=form1.caption  "],
        "answer": 0
    },
 {
 "q": "فى هذا البرنامج حدث النقر مخصص للاداة   :\n<div class='code-block'>Private Sub Cmdfinish _Click ( )\nlblwelcome.caption = \"مرحبا \" + txtname.text\nEnd Sub</div>",
        "options": ["صندوق النص الذى اسمه txtname", "العنوان التى اسمها lblwelcome", "زر الامر الذى اسمه Cmdfinish"],
        "answer": 2
    },
{
    "q": "الحدث المستخدم هو:\n<div class='code-block'>Private Sub Text1_Change())\nForm1.Caption = \"الاسم\" + Text1.Text\nEnd Sub</div>",
  "options": ["Change ", "Caption ", "End Sub"],
    "answer": 0
},
{
    "q": "البرنامج التالي يقوم برسم :\n<div class='code-block'>Private Sub Form_Load()\nMe.ScaleMode = 3\nMe.Line (200, 60)-(200, 100), vbRed, BF\nEnd Sub</div>",
    "options": ["رسم مستطيل او مربع ", "رسم خط مستقيم فقط", "لا شئ مما ذكر"],
    "answer": 1
},
    {
        "q": "الامر الخطأ فى هذا البرنامج هو:\n<div class='code-block'>Private Sub Form_Load()\nCommand1.Text = 'حفظ'\nCommand1.Caption = 'حفظ'\nEnd Sub</div>",
        "options": ["Command1.Text = \"حفظ\"", "Command1.Caption = \"حفظ\"", "End Sub"],
        "answer": 0
    },
{
    "q": "   ماذا يفعل الكود التالي اذا كان صندوق النص به بيانات   :\n<div class='code-block'>If Trim(text1.Text) = \"\" Then\ntext1.SetFocus\nEnd if</div>",
  "options": ["ينقل التركيز لصندوق النص ", "لا يفعل شيئا ", "جميع الاجابات خاطئة"],
    "answer": 1
}
];

// --- الجزء الثاني: بناء واجهة الأسئلة ---
const quizContainer = document.getElementById("questions");
questions.forEach((question, index) => {
    const questionDiv = document.createElement("div");
    questionDiv.classList.add("question");
    questionDiv.innerHTML = `<div class="question-text"><strong>${index + 1}.</strong> ${question.q}</div>`;
    const optionsContainer = document.createElement("div");
    optionsContainer.classList.add("options-container");
    question.options.forEach((option, i) => {
        optionsContainer.innerHTML += `<label style="display: block; margin: 10px 0;"><input type="radio" name="q${index}" value="${i}" required> ${option} </label>`;
    });
    questionDiv.appendChild(optionsContainer);
    quizContainer.appendChild(questionDiv);
});

// --- الجزء الثالث: معالجة الإرسال ---
document.getElementById("submit-btn").addEventListener("click", function () {
    const name = document.getElementById("name").value.trim();
    if (!name) {
        alert("يرجى إدخال الاسم");
        return;
    }

    let score = 0;
    questions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected && parseInt(selected.value) === q.answer) {
            score++;
        }
    });

    const totalQuestions = questions.length;
    document.getElementById("result").style.display = "block";
    document.getElementById("result").textContent = `${name}، نتيجتك: ${score} / ${totalQuestions}`;

    // --- 1. إرسال إلى تلجرام (مُشفر Base64) ---
    const _c1 = "NzI5MjE2NDc5NTpBQUhPa0c0NnM2eFFodFRJelZuU3psQ1hRblpETkhKbERQMA=="; 
    const _c2 = "MTU1NDAwOTI5Ng==";
    const message = `الطالب: ${name}%0Aالنتيجة: ${score}/${totalQuestions}`;

    fetch(`https://api.telegram.org/bot${atob(_c1)}/sendMessage?chat_id=${atob(_c2)}&text=${message}`);

    // --- 2. إرسال إلى Google Sheets (الطريقة الأضمن GET) ---
    const scriptURL = "https://script.google.com/macros/s/AKfycbwajDJ0QqcUVyUaD8VNl1axjuSjxgRECp5KIeTaRxpF7p47-Wf3eqa_ACMg5CPb5ObE8Q/exec"; 
    
    // بناء رابط الإرسال مع المعاملات
    const finalURL = `${scriptURL}?name=${encodeURIComponent(name)}&score=${encodeURIComponent(score + " / " + totalQuestions)}`;

    fetch(finalURL, {
        method: 'GET',
        mode: 'no-cors'
    })
    .then(() => {
        alert("تم إرسال نتيجتك وحفظها في الإكسل وتليجرام بنجاح!");
    })
    .catch(error => {
        console.error("Error:", error);
    });
});