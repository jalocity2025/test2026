const questions = [
    {
        "q": "أصبح إلقاء العروض التقديمية من المهارات التي يحتاجها الجميع",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "يجب أن يحتوي العرض التقديمي على نصوص فقط",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "لجعل العرض التقديمي شيقاً يمكننا الاستعانة بالوسائط المتعددة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "استخدام الوسائط المتعددة في العرض التقديمي يجعل المتلقي أكثر تركيزاً وانتباهاً",
        "options": [
           "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "يمكن إدراج الصور التوضيحية إلى شرائح العرض التقديمي.",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "لا يمكن أن يحتوي العرض التقديمي على أي مقاطع صوتية",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "يعتبر برنامج \"بوربوينت\" (PowerPoint) أحد برامج إنشاء العروض التقديمية",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "لتشغيل برنامج \"بوربوينت\" ننقر على رمز البرنامج من قائمة \"ابدأ\"",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "لا يمكن إدراج الصور من وسائط تخزين خارجية",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "يمكننا كتابة النصوص بداخل شرائح العرض التقديمي.",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "لا يمكن التحكم في حجم أو ألوان النصوص في برنامج البوربوينت",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "يمكننا تسجيل مقطع صوتي مباشرة من داخل برنامج البوربوينت",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "يمكن إدراج مقاطع فيديو لتعزيز العرض التقديمي",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "صُمم برنامج \"بوربوينت\" (PowerPoint) لـ",
        "options": [
            "إنشاء جداول بيانات",
            "كتابة رسائل نصية فقط",
            "إنشاء وإلقاء العروض التقديمية",
            "تصميم قواعد بيانات معقدة"
        ],
        "answer": 2
    },
    {
        "q": "لجعل العرض التقديمي أكثر تشويقاً وتأثيراً نستخدم",
        "options": [
            "نصوصاً طويلة جداً",
            "خلفيات بيضاء فقط",
            "الوسائط المتعددة (صور، صوت، فيديو)",
            "شريحة واحدة فقط"
        ],
        "answer": 2
    },
    {
        "q": "عند إدراج صورة في الشريحة، يمكننا التحكم في",
        "options": [
            "حجم الصورة",
            "موقع الصورة",
            "تدوير الصورة",
            "جميع الإجابات صحيحة"
        ],
        "answer": 3
    },
    {
        "q": "لإدراج مقطع صوتي من ملف مخزن على الجهاز نختار",
        "options": [
            "إدراج --> صورة",
            "إدراج --> قصاصة فنية",
            "إدراج --> صوت -> صوت من ملف",
            "إدراج --> نص"
        ],
        "answer": 2
    },
    {
        "q": "يمكن ضبط تشغيل المقطع الصوتي في الشريحة ليكون",
        "options": [
            "تلقائياً عند ظهور الشريحة او   عند النقر بالفأرة",
            "لا يمكن التحكم في وقت التشغيل"
        ],
        "answer": 0
    },
    {
        "q": "أيقونة \"مكبر الصوت\" التي تظهر على الشريحة تدل على",
        "options": [
            "وجود خطأ في البرنامج",
            "وجود ملف صوتي مدرج في هذه الشريحة",
            "أن الصوت مكتوم",
            "أن الشريحة تحتوي على نص فقط"
        ],
        "answer": 1
    },
    {
        "q": "القصاصات الصوتية  هي",
        "options": [
            "ملفات صوتية طويلة جداً",
            "مقاطع صوتية قصيرة وجاهزة (مثل التصفيق أو الجرس)",
            "برامج لتسجيل الصوت",
            "لا شيء مما سبق"
        ],
        "answer": 1
    },
    {
        "q": "الميزة الأساسية لاستخدام الفيديو في العرض التقديمي هي",
        "options": [
            "زيادة حجم الملف فقط",
            "توضيح المفاهيم الصعبة التي لا تكفيها الصور الثابتة",
            "إبطاء عملية العرض"
        ],
        "answer": 1
    },
    {
        "q": "لتنسيق النصوص في الشريحة (تغيير الخط، اللون، الحجم) نستخدم تبويب",
        "options": [
            "إدراج",
            "الصفحة الرئيسية",
            "عرض",
            "مراجعة"
        ],
        "answer": 1
    },
    {
        "q": "تساهم العروض التقديمية في الحملات التسويقية من خلال",
        "options": [
            "جذب انتباه الزبائن",
            "عرض مميزات المنتج بشكل مرئي",
            "تقليل الأخطاء البشرية أثناء الشرح",
            "جميع الإجابات صحيحة"
        ],
        "answer": 3
    },
    {
        "q": "يؤدي استخدام   الوسائط المتعددة   في العرض التقديمي إلى جعل المتلقي   أكثر تركيزاً وانتباهاً.",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "يُعتبر برنامج   \"بوربوينت\" (PowerPoint)   أداة تُستخدم لتسهيل مهمة المتحدث في   تذكر النقاط الرئيسية   أثناء العرض.",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "لا يمكن   تسجيل الصوت مباشرة   من داخل برنامج \"بوربوينت\"، بل يجب دائماً إدراج ملف صوتي من خارج البرنامج",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "يُعد ظهور   أيقونة مكبر الصوت   على شريحة العرض دليلاً على وجود   مقطع صوتي   في تلك الشريحة.",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "لتشغيل برنامج العروض التقديمية، يجب النقر على   رمز البرنامج   الموجود في قائمة   \"ابدأ\"",
        "options": [
            "صح",
            "خطأ ."
        ],
        "answer": 0
    },
    {
        "q": "لإدراج مقطع فيديو (فيلم) في العرض التقديمي، نستخدم تبويب",
        "options": [
            "الصفحة الرئيسية.",
            "ملف.",
            "إدراج.",
            "عرض."
        ],
        "answer": 2
    },
    {
        "q": "من الأمثلة على \"القصاصات الصوتية\" الجاهزة التي يمكن استخدامها في العروض التقديمية",
        "options": [
            "صوت رنين الهاتف",
            "صوت التصفيق",
            "الأصوات الشائعة",
            "جميع الإجابات صحيحة"
        ],
        "answer": 3
    },
    {
        "q": "تكمن أهمية الصور الثابتة في العرض التقديمي في أنها",
        "options": [
            "تزيد من حجم الملف فقط",
            "تشكل عنصراً هاماً لتوضيح الأفكار بأيسر الطرق",
            "تجعل العرض مملاً للمشاهد",
            "لا يمكن إدراجها في الشرائح"
        ],
        "answer": 1
    },
    {
        "q": "الوسائط المتعددة",
        "options": [
            "يمكن إدراجها بالنقر بزر الفأرة الأيمن على  لوح التفاصيل",
            "تجعل العرض التقديمي   شائقاً وجذاباً   للمشاهد",
            "تساهم في   تفادي الأخطاء البشرية   أثناء الحملات التسويقية",
            "يساعد المتحدث على   تتبع الحديث   دون نسيان التفاصيل"
        ],
        "answer": 1
    },
    {
        "q": "شريحة جديدة",
        "options": [
            "يمكن إدراجها بالنقر بزر الفأرة الأيمن على  لوح التفاصيل",
            "يمكن إدراجها بالنقر بزر الفأرة الأيمن على شريحة فى  لوح التفاصيل"
        ],
        "answer": 0
    },
    {
        "q": "برمجيات العروض",
        "options": [
            "تستخدم الانتاج ملفات الفيديو",
            "تستخدم لتصفح الانترنت",
            "تستخدم لا نتاج ملفات العروض التقديمية",
            "تستخدم لتعديل اصور"
        ],
        "answer": 2
    },
    {
        "q": "عند اضافة شريحة جديدة  يكون تخطيطها",
        "options": [
            "عنوان و عنوان فرعي",
            "عوان و محتوى"
        ],
        "answer": 1
    },
    {
        "q": "لترتيب افكار متحدث امام جمهور يستخدم",
        "options": [
            "ماسح ضوئي",
            "عرض تقديمي",
            "الة تصوير رقمية",
            "جميع الاجابات خاطئة"
        ],
        "answer": 1
    },
    {
        "q": "من اجل جعل العرض اكثر تشويقا و لترك انطباع جيد فان العرض يجب ان",
        "options": [
            "يكون مجهز بالشرائح الشيقة",
            "لا يتخلله عرض شرائح مملة",
            "يتم اضافة الصور و الفيديو للشرا ئح",
            "جميع الاجابات صحيحة"
        ],
        "answer": 3
    },
    {
        "q": "يمكن ادراج ملف فيديو",
        "options": [
            "ننقر على فيلم من تبويب ادراج",
            "ننقر على فيلم من تبويب الصفحة الرئيسية",
            "ننقر على فيلم من تبويب عرض",
            "ننقر على فيلم من تبويب حركات"
        ],
        "answer": 0
    },
    {
        "q": "توجد طريقتين للتحكم فى كيفية عرض الفيديو على الشريحة تلقائيا و عند النقر",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "يمكن تسجيل الصوت برنامج المسجل و استخدام اداة",
        "options": [
            "لاقط الصوت",
            "السماعات",
            "بطاقة الصوت",
            "باستخدام لاقط الصوت وبطاقة الصوت  معا"
        ],
        "answer": 3
    },
    {
        "q": "عند تشغيل برنامج بوربوينت يظهر مستند جديد الشريحة الافتراضية تخطيطها",
        "options": [
            "عنوان و عنوان فرعي",
            "عوان و محتوى"
        ],
        "answer": 0
    },
    {
        "q": "من خيارات تشغيل ملف الفيديو بعد إضافته للشريحة",
        "options": [
            "التشغيل السريع فقط",
            "التشغيل للخلف",
            "التشغيل تلقائياً أو عند النقر على أي زر",
            "لا توجد خيارات للتحكم"
        ],
        "answer": 2
    }
];
// --- الجزء الثاني: بناء واجهة الأسئلة ---
const quizContainer = document.getElementById("questions");
questions.forEach((question, index) => {
    const questionDiv = document.createElement("div");
    questionDiv.classList.add("question");
    questionDiv.innerHTML = `<div class="question-text"><strong>${index + 1}.</strong> ${question.q}</div>`;
    const optionsContainer = document.createElement("div");
    optionsContainer.classList.add("options-container");
    question.options.forEach((option, i) => {
        optionsContainer.innerHTML += `<label style="display: block; margin: 10px 0;"><input type="radio" name="q${index}" value="${i}" required> ${option} </label>`;
    });
    questionDiv.appendChild(optionsContainer);
    quizContainer.appendChild(questionDiv);
});

// --- الجزء الثالث: معالجة الإرسال ---
document.getElementById("submit-btn").addEventListener("click", function () {
    const name = document.getElementById("name").value.trim();
    if (!name) {
        alert("يرجى إدخال الاسم");
        return;
    }

    let score = 0;
    questions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected && parseInt(selected.value) === q.answer) {
            score++;
        }
    });

    const totalQuestions = questions.length;
    document.getElementById("result").style.display = "block";
    document.getElementById("result").textContent = `${name}، نتيجتك: ${score} / ${totalQuestions}`;

    // --- 1. إرسال إلى تلجرام (مُشفر Base64) ---
    const _c1 = "NzI5MjE2NDc5NTpBQUhPa0c0NnM2eFFodFRJelZuU3psQ1hRblpETkhKbERQMA=="; 
    const _c2 = "MTU1NDAwOTI5Ng==";
    const message = `الطالب: ${name}%0Aالنتيجة: ${score}/${totalQuestions}`;

    fetch(`https://api.telegram.org/bot${atob(_c1)}/sendMessage?chat_id=${atob(_c2)}&text=${message}`);

    // --- 2. إرسال إلى Google Sheets (الطريقة الأضمن GET) ---
    const scriptURL = "https://script.google.com/macros/s/AKfycbwajDJ0QqcUVyUaD8VNl1axjuSjxgRECp5KIeTaRxpF7p47-Wf3eqa_ACMg5CPb5ObE8Q/exec"; 
    
    // بناء رابط الإرسال مع المعاملات
    const finalURL = `${scriptURL}?name=${encodeURIComponent(name)}&score=${encodeURIComponent(score + " / " + totalQuestions)}`;

    fetch(finalURL, {
        method: 'GET',
        mode: 'no-cors'
    })
    .then(() => {
        alert("تم إرسال نتيجتك وحفظها في الإكسل وتليجرام بنجاح!");
    })
    .catch(error => {
        console.error("Error:", error);
    });
});