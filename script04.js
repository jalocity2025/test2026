const questions = [
    {
        "q": "الوسيط (Media) هو وعاء افتراضي لتمثيل أي نوع من المعلومات سواء نصية أو رسومية أو صوتية.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "من عناصر الوسائط المتعددة الصور والرسوم.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "تستخدم الوسائط المتعددة في عقد المؤتمرات عن بعد.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "السماعات هي إحدى طرفيات الحاسوب المستخدمة في تسجيل الأصوات.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "من معدات الوسائط المتعددة الطابعات.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يمثل امتداد JPG ملفات الصوت التي يمكن استخدامها في ملفات الوسائط المتعددة.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "جميع أنواع الصور يمكن تحريرها بالرسام.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمثل امتداد wmv ملفات الفيديو التي يمكن استخدامها في ملفات الوسائط المتعددة.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمكن إنتاج ملفات الصوت في نظام ويندوز بواسطة برنامج ريل بلاير (Real Player).",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "تمكن العروض التقديمية الأشخاص من إقامة حملات تسويقية لمنتجاتهم.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمكن عرض جميع أنواع الفيديو باستخدام برنامج عارض الوسائط.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "لا يمكن استخدام برامج خاصة لتحويل الصور الثابتة المنتجة بواسطة الرسام  وجعلها صور متحركة.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "نسبة الاستيعاب السمعي والبصري 70 %.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يقصد بقصاصة وسائط ملفات الصوت.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يقصد بقصاصة صوتية ملفات الصوت.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "المستفيد الأكبر من استخدام الوسائط المتعددة هم رياض الأطفال.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "الوسائط التقليدية لتدوين المعلومات هي...",
        "options": ["البريد الإلكتروني", "الحواسيب الرقمية", "النصوص الورقية", "كل ما سبق"],
        "answer": 2
    },
    {
        "q": "بينت بعض الدراسات أن الإنسان يستطيع تذكر 20% من المعلومات التي يتلقاها بواسطة السمع فقط.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "لكي يستطيع المتحدث تجنب ملل الحاضرين يجب أن يستعين بـ..",
        "options": ["وضع العرض بكامله في شريحة واحدة", "استخدام شرائح منسقة تحتوي على نصوص وصور وفيديو", "استخدام الخطوط الكبيرة وألوان متعددة"],
        "answer": 1
    },
    {
        "q": "للبشر قدرة فائقة في التعامل مع البيانات وتذكرها.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يمكن تسجيل الصوت عبر نظام ويندوز بواسطة:",
        "options": ["برنامج المسجل (SOUND RECORDER)", "برنامج ميكروسوفت وورد (MICROSOFT WORD)", "الرسام (Paint)", "برنامج عارض الوسائط (MEDIA PLAYER)"],
        "answer": 0
    },
    {
        "q": "يمكن إنتاج الرسوم باستخدام العديد من الوسائل باستثناء ....",
        "options": ["برنامج الرسام Paint", "برنامج مشغل الوسائط Media player", "آلات التصوير", "الماسح الضوئي"],
        "answer": 1
    },
    {
        "q": "تستخدم في الألعاب والتدريب الافتراضي والتعليم فتزيد من القدرة على الاستيعاب:",
        "options": ["الوسائط المتعددة", "أشرطة الفيديو", "أقراص الأسطوانات", "الليزر"],
        "answer": 0
    },
    {
        "q": "يمكن تسجيل الصوت ببرنامج المسجل واستخدام أداة:",
        "options": ["لاقط الصوت", "السماعات", "بطاقة الصوت", "لاقط الصوت وبطاقة الصوت معاً"],
        "answer": 3
    },
    {
        "q": "يمكننا التحكم في شكل الحروف من خلال اختيار حجم الحروف أو ألوانها أو أنواع الخطوط.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "في الصحافة الإلكترونية:",
        "options": ["تدعم الأخبار بمقاطع فيديو تتعلق بالأخبار المنشورة", "تمكن القارئ من التعليق وإبداء رأيه (التفاعل مع الخبر)", "تتيح للقارئ متابعة الأخبار الأخرى ذات الصلة", "جميع الإجابات صحيحة"],
        "answer": 3
    },
    {
        "q": "قرص التخزين الليزري أحد المكونات الرئيسية لإنتاج وتخزين الوسائط المتعددة.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "النصوص الورقية: هي الوسيط الشائع للتعامل مع برمجيات الحاسوب.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "النص أفضل من الصور لعرض الفكرة.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يستخدم الماسح الضوئي لإنشاء وتجهيز ملفات الصور الثابتة.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "باستخدام برنامج 'منتج الأفلام' (Movie Maker) يمكننا إنتاج فيلم مرئي (فيديو).",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "المعلومات التي يتلقاها الإنسان بواسطة السمع والبصر معاً، يستطيع تذكر:",
        "options": ["20  %منها.", "40   % منها.", "70  % منها"],
        "answer": 2
    },
    {
        "q": "لتحويل الصور من صيغتها الورقية إلى صيغة رقمية نستخدم:",
        "options": ["الطابعة.", "الماسح الضوئي (Scanner)", "لوحة المفاتيح.", "الفأرة."],
        "answer": 1
    },
    {
        "q": "الامتداد (GIF) يستخدم عادة لملفات:",
        "options": ["الصوت.", "النصوص.", "الصور المتحركة البسيطة.", "ملفات الفيديو الكبيرة."],
        "answer": 2
    },
    {
        "q": "الرسوم المتحركة هي:",
        "options": ["سلسلة من الرسوم الثابتة عند عرضها تزامنيًا تبدو وكأنها متحركة.", "صورة ثابتة يتم إنشاؤها ببرنامج الرسام.", "ملف يتم إنتاجه ببرنامج المسجل.", "جميع الإجابات صحيحة."],
        "answer": 0
    },
    {
        "q": "لإنشاء ملف صوتي نستخدم برنامج:",
        "options": ["الرسام (Paint).", "منتج الأفلام (Movie Maker).", "المسجل (Sound Recorder).", "عارض الوسائط (Media Player)."],
        "answer": 2
    },
    {
        "q": "الصور والرسوم المتحركة هي مقاطع تُعرض بصورة تزامنية لتبدو متحركة.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمكن عرض مشاهد الفيديو عبر نظام ويندوز بواسطة:",
        "options": ["برنامج المسجل SOUND RECORDER", "برنامج ميكروسوفت وورد MICROSOFT WORD", "الرسام", "برنامج عارض الوسائط MEDIA PLAYER"],
        "answer": 3
    },
    {
        "q": "يمكن عرض ملفات الفيديو ذات الامتداد RM باستخدام برنامج:",
        "options": ["الميديا بلاير MEDIA PLAYER", "الريل بلاير REAL PLAYER", "مسجل الصوت SOUND RECORDER", "منتج الأفلام WINDOWS MOVIE MAKER"],
        "answer": 1
    },
    {
        "q": "تساهم بعض ألعاب الحاسوب في تعزيز أهم حواس الأطفال وهي حاسة:",
        "options": ["السمع", "الانتباه", "الذكاء", "البصر"],
        "answer": 2
    },
    {
        "q": "الامتداد (WMV) يستخدم لملفات:",
        "options": ["الصوت فقط", "الصور المتحركة", "الفيديو (Windows Media Video)", "النصوص"],
        "answer": 2
    },
    {
        "q": "لاقط الصوت يمكن من خلاله سماع الأصوات الصادرة عن الحاسوب.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "الامتداد (MP3) هو أحد أشهر امتدادات ملفات الفيديو.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "من الأجهزة المستخدمة في إنتاج وعرض الوسائط المتعددة:",
        "options": ["الطابعة", "الماسح الضوئي", "لوحة المفاتيح", "جميع ما سبق صحيح"],
        "answer": 1
    },
    {
        "q": "من تطبيقات الوسائط المتعددة:",
        "options": ["الصحافة الإلكترونية", "التدريب الافتراضي", "عقد المؤتمرات عن بعد", "جميع ما سبق صحيح"],
        "answer": 3
    },
    {
        "q": "استخدام الوسائط المتعددة ضمن أساليب التعليم:",
        "options": ["يجعل قدرة الطلاب محدودة", "يسهم في انخفاض جودة المنهج", "يجعل التعليم أكثر رتابة", "يمنح الطالب فرصاً أكبر في الاستيعاب والاستمتاع"],
        "answer": 3
    },
    {
        "q": "أي من المصطلحات التالية يعتبر امتداداً لملف صوتي:",
        "options": ["Gif", "bmp", "Mpeg", "Mp3"],
        "answer": 3
    },
    {
        "q": "الامتداد bmp يعتبر امتداداً لملف:",
        "options": ["صوتي", "فيديو", "صورة", "جميع ما سبق غير صحيح"],
        "answer": 2
    },
    {
        "q": "تقدم الوسائط المتعددة شكلاً جديداً من الإعلام يشرك الجمهور ولا يعتبر المستخدم متلقياً فقط.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "التدريب الافتراضي يقوم على تجهيز نماذج تشبيهية يتعامل معها المتدرب كأنها طبيعية.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "الوسائط المتعددة قادرة على إثراء مدارك الأطفال الحسية في مرحلة رياض الأطفال.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "السماعات تعتبر إحدى طرفيات الحاسوب المستخدمة في إخراج الأصوات.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "من مزايا التدريب الافتراضي:",
        "options": ["توفير مستلزمات التدريب المستهلكة", "رفع كفاءة المتدرب", "كل ما سبق صحيح"],
        "answer": 2
    },
    {
        "q": "لا يمكن استخدام برامج خاصة لتحويل الصوتيات المنتجة بواسطة أجهزة التسجيل.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "شاشة العرض قديماً كانت تظهر النصوص فقط وليس لها القدرة على إظهار الصور.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "من الامتدادات المميزة لملفات الصور: bmp - Gif - Jpeg.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يمكن إنتاج الرسوم باستخدام العديد من الوسائل التالية باستثناء:",
        "options": ["برنامج عارض الوسائط Media Player", "مسجل الصوت Sound Recorder", "برنامج منتج الأفلام Windows Movie Maker", "كل ما سبق صحيح"],
        "answer": 3
    },
    {
        "q": "الصور والرسوم المتحركة هي عبارة عن مقاطع يتم إنتاجها:",
        "options": ["بواسطة الماسح الضوئي", "كسلسلة من الصور المنفصلة التي تُعرض تزامنيًا", "من الصور الثابتة المدمجة بتقنية القص"],
        "answer": 1
    }
];
// --- الجزء الثاني: بناء واجهة الأسئلة ---
const quizContainer = document.getElementById("questions");
questions.forEach((question, index) => {
    const questionDiv = document.createElement("div");
    questionDiv.classList.add("question");
    questionDiv.innerHTML = `<div class="question-text"><strong>${index + 1}.</strong> ${question.q}</div>`;
    const optionsContainer = document.createElement("div");
    optionsContainer.classList.add("options-container");
    question.options.forEach((option, i) => {
        optionsContainer.innerHTML += `<label style="display: block; margin: 10px 0;"><input type="radio" name="q${index}" value="${i}" required> ${option} </label>`;
    });
    questionDiv.appendChild(optionsContainer);
    quizContainer.appendChild(questionDiv);
});

// --- الجزء الثالث: معالجة الإرسال ---
document.getElementById("submit-btn").addEventListener("click", function () {
    const name = document.getElementById("name").value.trim();
    if (!name) {
        alert("يرجى إدخال الاسم");
        return;
    }

    let score = 0;
    questions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected && parseInt(selected.value) === q.answer) {
            score++;
        }
    });

    const totalQuestions = questions.length;
    document.getElementById("result").style.display = "block";
    document.getElementById("result").textContent = `${name}، نتيجتك: ${score} / ${totalQuestions}`;

    // --- 1. إرسال إلى تلجرام (مُشفر Base64) ---
    const _c1 = "NzI5MjE2NDc5NTpBQUhPa0c0NnM2eFFodFRJelZuU3psQ1hRblpETkhKbERQMA=="; 
    const _c2 = "MTU1NDAwOTI5Ng==";
    const message = `الطالب: ${name}%0Aالنتيجة: ${score}/${totalQuestions}`;

    fetch(`https://api.telegram.org/bot${atob(_c1)}/sendMessage?chat_id=${atob(_c2)}&text=${message}`);

    // --- 2. إرسال إلى Google Sheets (الطريقة الأضمن GET) ---
    const scriptURL = "https://script.google.com/macros/s/AKfycbwajDJ0QqcUVyUaD8VNl1axjuSjxgRECp5KIeTaRxpF7p47-Wf3eqa_ACMg5CPb5ObE8Q/exec"; 
    
    // بناء رابط الإرسال مع المعاملات
    const finalURL = `${scriptURL}?name=${encodeURIComponent(name)}&score=${encodeURIComponent(score + " / " + totalQuestions)}`;

    fetch(finalURL, {
        method: 'GET',
        mode: 'no-cors'
    })
    .then(() => {
        alert("تم إرسال نتيجتك وحفظها في الإكسل وتليجرام بنجاح!");
    })
    .catch(error => {
        console.error("Error:", error);
    });
});