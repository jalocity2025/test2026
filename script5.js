const questions = [
    {
        "q": "تسمي المصفوفة التي يتم تحديد عناصرها في جمل البرنامج باستخدام دليل واحد بالمصفوفة ذات البعد الواحد",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "للتعامل مع المصفوفة ذات البعدين فإننا نستخدم حلقتي دوران احداهما لعدد الصفوف و الأخرى لعدد الاعمدة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "تستخدم جملة الاعلان  ( dim  ) لتحديد عدد عناصر المصفوفة المطلوبة فقط",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "باستخدام المصفوفة يمكن استخدام اسم متغير واحد فقط في تخزين مجموعة من القيم بدلاً من استخدام اعداد كبيرة من أسماء المتغيرات",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },

    {
        "q": "في المصفوفة Dim A(1 To 5, 2 To 6) As Integer يكون عدد عناصر الصفوف مساوياً لعدد عناصر الأعمدة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
 {
        "q": "يجب ان يكون اسم المصفوفة مقبولاً بلغة البيسك المرئي بحيث يجب أن لا يكون احد الكلمات المحجوزة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "تستخدم جملة الاعلان DIM لتحديد نوع البيانات المراد تخزينها بالمصفوفة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "تسمي المصفوفة التي يتم تحديد عناصرها في جمل البرنامج باستخدام دليل فهرس واحد بالمصفوفة ذات البعدين",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "للتعامل مع المصفوفة ذات البعد الواحد فإننا نستخدم حلقتي دوران احداهما لعدد الصفوف و الأخرى لعدد الاعمدة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "المصفوفة عبارة عن مجموعة متجاورة من المواقع في الذاكرة تحتوي على عناصر من نفس النوع",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "نستخدم جملة اعلان المصفوفة لتحديد عدد عناصر المصفوفة المطلوبة وكذلك نوع البيانات المراد تخزينها بها",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "تتكون المصفوفة ذات البعدين من عمودين",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "عدد ادلة الفهارس في المصفوفة يساوي عدد عناصرها",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "جملة إعلان المصفوفة Dim myarray(9) as Integer تحجز 9 مواقع للمصفوفة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "يتم إعلان المصفوفة في الجزء General في أعلى النموذج",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "المصفوفة (4,3)myarray  مصفوفة تتكون من ثلاث صفوف وأربعة أعمدة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "الجملة Dim Value As Integer تعني مصفوفة من النوع الحرفي",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "تتكون هذه المصفوفة dim a(3,4) as integer  من أربعة عناصر من النوع",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "الامر (    Dim x(50   ) تقوم هذه الجملة بحجز 50 موقع للمصفوفة x في الذاكرة",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "الجملة Dim A(1 to 5) as intger تشير إلى إنشاء مصفوفة اسمها A وعدد عناصرها 6 لتخزين بيانات رقمية صحيحة   .",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "تقاطع الصف مع العمود في المصفوفة ثنائية البعد يكون ما يسمى خلية أو العنصر ويكون عنوانها رقم الصف مع رقم العمود",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "تستخدم المصفوفة ذات البعدين  فهرسين دليل فهرس للأعمدة ودليل فهرس للصفوف",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },
    {
        "q": "في جملة الإعلان DIM Arr(1 to 4) as single الاسم arr يشير إلى اسم مصفوفة مكونة من خمسة مواقع فقط",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 1
    },
    {
        "q": "يمكن تخصيص أو إدخال القيم المطلوبة لكل موقع من مواقع المصفوفة من داخل جمل الدوران",
        "options": [
            "صح",
            "خطأ"
        ],
        "answer": 0
    },

    {
        "q": "يمكن أن تحتوي المصفوفة الواحدة على أنواع بيانات مختلفة",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يبدأ فهرس المصفوفة ذات البعد الواحد من الرقم صفر افتراضيًا",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "المصفوفة ذات البعدين تحتوي على صفوف فقط دون أعمدة.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "القطر الرئيسي للمصفوفة ذات البعدين هو مجموعة العناصر التي يتساوى فيها رقم الصف مع رقم العمود.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "الجملة الصحيحة لإعلان مصفوفة أحادية البعد تحتوي على 10 عناصر من نوع Integer هي:",
        "options": [
            "Dim A(1 To 10) As Integer",
            "Dim A(10) As Integer",
            "كلا العبارتين صحيحتان",
            "لا شيء مما سبق"
        ],
        "answer": 0
    },
    {
        "q": "الجملة الصحيحة لإعلان مصفوفة ثنائية البعد 4 × 4 من نوع String هي:",
        "options": [
            "Dim A(4,4) As String",
            "Dim A(3,3) As String",
            "Dim A(0 To 4, 0 To 4) As String",
            "لا شئ مما ذكر"
        ],
        "answer": 1
    },
{
        "q": "عند تنفيذ الأمر Print A(3, 2) في مصفوفة تم الإعلان عنها Dim A(2, 3)، ماذا يحدث؟",
        "options": [
            "يطبع القيمة صفر",
            "يطبع القيمة فارغة",
            " رسالة خطأ",
            "يطبع فهرس العنص"
        ],
        "answer": 2
    },
    {
        "q": "جملة تعريف مصفوفة ذات بعدين تحتوي على أربعة صفوف وثلاثة أعمدة، ونوع البيانات سلسلة حرفية (String) هى",
        "options": [
            "Dim myArray(3, 2) As String",
            "Dim myArray(1 To 4, 1 To 3) As String",
            "كلا العبارتين صحيحتان"
        ],
        "answer": 2
    },
    {
        "q": "إذا كان لدينا المصفوفة التالية فان مجموع عناصر قطر المصفوفة :\n<div class='code-block'>A(0,0)=5  A(0,1)=7\nA(1,0)=2     A(1,1)=9</div>",
        "options": ["7", "11", "14"],
        "answer": 2
    },
{
        "q": "ما هو عدد المرات التي ستنفذ فيها الجملة X = X + 1 في الكود التالي :\n<div class='code-block'>For i = 1 To 3\nFor j = 1 To 2\nX = X + 1\n Next j\n Next i</div>",
        "options": ["3", "9", "6"],
        "answer": 1
    },
    
    {
        "q": "لتنفيذ حلقة لإدخال عناصر مصفوفة أحادية البعد من 0 إلى 9 نستخدم:",
        "options": [
            "For i=1 To 10",
            "For i=0 To 10",
            "For i=0 To 9",
            "For i=1 To 9"
        ],
        "answer": 2
    },
    {
        "q": "عند البحث عن عنصر داخل مصفوفة أحادية البعد، فإننا:",
        "options": [
            "نقارن العنصر مع جميع عناصر المصفوفة",
            "نبحث فقط في أول عنصر.",
            "نبحث فقط في آخر عنصر.",
            "لا يمكن البحث داخل المصفوفة."
        ],
        "answer": 0
    },
    {
        "q": "عند إعلان مصفوفة ذات بعد واحد من 20 عنصرًا رقم صحيحًا نستخدم:",
        "options": [
            "Dim A(19) As Integer",
            "Dim A(20) As Integer",
            "Dim A(1 To 21) As Integer"
        ],
        "answer": 0
    },
    {
        "q": "لتخزين بيانات في مصفوفة ثنائية البعد من 3 صفوف و 4 أعمدة نكتب:",
        "options": [
            "Dim B(3,4) As Integer",
            "Dim B(2,3) As Integer",
            "Dim B(1 To 2, 1 To 3) As Integer"
        ],
        "answer": 1
    },
    {
        "q": "عند البحث عن عنصر في مصفوفة ثنائية البعد:",
        "options": [
            "نحتاج استخدام حلقة واحدة فقط.",
            "نحتاج استخدام حلقتين متداخلتين (للصفوف والأعمدة)",
            "لا يمكن البحث داخل المصفوفة",
            "يتم البحث باستخدام جملة Print."
        ],
        "answer": 1
    },
    {
        "q": "القطر الرئيسي في مصفوفة (3 × 3) يشمل:",
        "options": [
            "A(0,0), A(0,1), A(0,2)",
            "A(0,0), A(1,1), A(2,2)",
            "A(0,2), A(1,1), A(2,0)",
            "جميع العناصر في الصف الأول."
        ],
        "answer": 1
    },
    {
        "q": "البرنامج التالي يقوم ب :\n<div class='code-block'>Private Sub Command2_Click()\nFor i = 0 To 4\nPrint A(i)\nNext i\nEnd Sub</div>",
        "options": ["ادخال عناصر المصفوفة ", "طباعة عناصر المصفوفة", "جمع عناصر المصفوفة"],
        "answer": 1
    },
    {
        "q": "تقوم هذه الجملة DIM MATRIX ( 3 , 4 ) AS INTEGER بحجز",
        "options": [
            "4 مواقع",
            "7 مواقع",
            "20 موقع",
            "3 مواقع"
        ],
        "answer": 2
    },
    {
        "q": "كم عدد عناصر المصفوفة\n<div class='code-block'>FOR I = 0 TO 4\nFOR J = 0 TO 3\nPrint A( I , J )\nNEXT J\nNext I</div>",
        "options": ["20 ", "12", "7"],
        "answer": 0
    },

    {
        "q": "البرنامج التالي يقوم ب :\n<div class='code-block'>Private Sub Command2_Click()\nFor i = 0 To 2\nSUM = 0\nFOR J = 0 TO 2\nSUM = SUM + A ( I , J)\nNEXT J\nNext i\nPRINT I , SUM\nEnd Sub</div>",
        "options": ["ادخال عناصر المصفوفة ", "طباعة عناصر المصفوفة", "مجموع عناصركل صف للمصفوفة"],
        "answer": 2
    },
    {
        "q": "تتكون المصفوفة من مجموعة من الفهارس",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يمكن ان تكون المصفوفة من عدة انواع بيانية",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "يتميز كل عنصر داخل المصفوفة برقم (INDEX) فريد.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "المصفوفة طولها ثابت و لايمكن زيادته اثناء عمل البرنامج.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
    {
        "q": "يبدأ اعلان المصفوفة بتحديد النوع البياني للمصفوفة.",
        "options": ["صح", "خطأ"],
        "answer": 1
    },
    {
        "q": "لا يمكن الاعلان عن مصفوفة فارغة.",
        "options": ["صح", "خطأ"],
        "answer": 0
    },
//{
 //"q": "البرنامج التالي يقوم برسم :\n<div class='code-block'>Private Sub Form_Load()\nMe.ScaleMode = 3\nMe.Line (30, 30)-(100, 100), vbBlue, BF\nEnd Sub</div>",
 //   "options": ["رسم مستطيل او مربع ", "رسم خط مستقيم فقط", "لا شئ مما ذكر"],
 //   "answer": 0
//},
    {
        "q": "نوع المصفوفة فى هذا البرنامج :\n<div class='code-block'>Private Sub Command2_Click()\nFor i = 0 To 2\nFOR J = 0 TO 2\nPrint A(i, J)\nNEXT J\nNext i\nEnd Sub</div>",
        "options": ["مصفوفة ذات البعد الواحد ", "مصفوفة ذات البعدين", "مصفوفة متعددة الابعاد"],
        "answer": 1
    },
    {
        "q": "الامر الذي يعرف مصفوفة من 100 عنصر من النوع string",
        "options": [
            "Dim a(100) as string",
            "Dim a(99) as integer",
            "Dim a(99) as string"
        ],
        "answer": 2
    },
    {
        "q": "في المقطع التالي يتم حساب\n<div class='code-block'>\nFOR i=1 to 3\n Sum=0\n For j=1 to 3\n Sum=sum+a(i,j)\n Next j\n Print sum\n Next i\n</div>",
        "options": [
            "مجموع  عناصر كل صف",
            "مجموع  عناصر كل عمود",
            "مجموع عناصر المصفوفة بالكامل"
        ],
        "answer": 0
    },
    {
        "q": "حجم المصفوفة A من خلال هذا المقطع\n<div class='code-block'>\n Private sub command1_click()\n For i=0 to 4\n Print a(i)\n Next i\n End sub\n</div>",
        "options": [
            "0",
            "4",
            "5"
        ],
        "answer": 2
    },
    {
        "q": " يقوم هذا المقطع بتخزين\n<div class='code-block'>\nDim I as integer\nDim j as integer\nFor i = 0 to 4\n For j = 0 to 4\n M(i,j) = i + j\n Next j\n Next i\n</div>",
        "options": [
            "مجموع الفهرس  i   لكل عنصر",
            "مجموع الفهارس I , j   لكل عنصر",
            "مجموع عناصر كل صف"
        ],
        "answer": 1
    },
    {
        "q": " في المقطع تم الاعلان عن متغيرين من النوع:\n<div class='code-block'>\nDim I as integer\nDim j as integer\nFor i = 0 to 4\n For j = 0 to 4\n M(i,j) = i + j\n Next j\n Next i\n</div>",
        "options": [
            "الصحيح",
            "الحرفي",
            "المنطقي",
            "الكسري"
        ],
        "answer": 0
    },
    {
        "q": " في المقطع  عدد عناصر المصفوفة M هو\n<div class='code-block'>\nDim I as integer\nDim j as integer\nFor i = 0 to 4\n For j = 0 to 4\n M(i,j) = i + j\n Next j\n Next i\n</div>",
        "options": [
            "4",
            "25",
            "5"
        ],
        "answer": 1
    },
    {
        "q": " وظيفة هذا المقطع هي القيام بـ\n<div class='code-block'>\nPrivate sub command1_click()\n For I=0 to 7\n Print A(I)\n Next I\n End sub\n</div>",
        "options": [
            "ادخال العناصر",
            "طباعة العناصر",
            "ترتيب العناصر",
            "البحث عن عنصر"
        ],
        "answer": 1
    },
    {
        "q": " ماهي العبارة الخاطئة حول الجزء البرمجي التالي؟\n<div class='code-block'>\nPrivate sub form_load()\n For i=0 to 9\n Myarray (i) = i\n Next i\n End sub\n</div>",
        "options": [
            "تم ادخال 10 قيم تصاعدية",
            "تم تخزين الأعداد من 1 إلى 10",
            "ينفذ تلقائيا",
            "مصفوفة ذات بعد واحد ."
        ],
        "answer": 1
    },
    {
        "q": " عدد صفوف المصفوفة  a هو\n<div class='code-block'>\nprivate sub cmd1_click()\n dim i as integer\n dim jas integer\n for i=0 to 3\n for j=0 to 2\n a(i,j) = inputbox(\"ادخل القيمة\")\n next j\n next i\n end sub\n</div>",
        "options": [
            "4",
            "3",
            "12"
        ],
        "answer": 0
    },
    {
        "q": " تتبع الحلقتين المتداخلتين التاليتين  ماذا سيتم حسابه  إذا استبدلنا الجملة بـ Sum=sum+ a(j,i)\n<div class='code-block'>\nFor i=0 to 4\n Sum = 0\n For j=0 to 4\n Sum=sum+ a(i,j)\n Next j\n Print sum\n Next i\n</div>",
        "options": [
            "مجموع كل عناصر كل عمود",
            "مجموع  عناصر كل كل صف",
            "مجموع عناصر المصفوفة بالكامل"
        ],
        "answer": 1
    }
];
// --- الجزء الثاني: بناء واجهة الأسئلة ---
const quizContainer = document.getElementById("questions");
questions.forEach((question, index) => {
    const questionDiv = document.createElement("div");
    questionDiv.classList.add("question");
    questionDiv.innerHTML = `<div class="question-text"><strong>${index + 1}.</strong> ${question.q}</div>`;
    const optionsContainer = document.createElement("div");
    optionsContainer.classList.add("options-container");
    question.options.forEach((option, i) => {
        optionsContainer.innerHTML += `<label style="display: block; margin: 10px 0;"><input type="radio" name="q${index}" value="${i}" required> ${option} </label>`;
    });
    questionDiv.appendChild(optionsContainer);
    quizContainer.appendChild(questionDiv);
});

// --- الجزء الثالث: معالجة الإرسال ---
document.getElementById("submit-btn").addEventListener("click", function () {
    const name = document.getElementById("name").value.trim();
    if (!name) {
        alert("يرجى إدخال الاسم");
        return;
    }

    let score = 0;
    questions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected && parseInt(selected.value) === q.answer) {
            score++;
        }
    });

    const totalQuestions = questions.length;
    document.getElementById("result").style.display = "block";
    document.getElementById("result").textContent = `${name}، نتيجتك: ${score} / ${totalQuestions}`;

    // --- 1. إرسال إلى تلجرام (مُشفر Base64) ---
    const _c1 = "NzI5MjE2NDc5NTpBQUYxOTMzUFlOR1dlaUFXaEhTdDVHdi1EU3h4M0VWU1VoSQ=="; 
    const _c2 = "MTU1NDAwOTI5Ng==";
    const message = `الطالب: ${name}%0Aالنتيجة: ${score}/${totalQuestions}`;

    fetch(`https://api.telegram.org/bot${atob(_c1)}/sendMessage?chat_id=${atob(_c2)}&text=${message}`);

    // --- 2. إرسال إلى Google Sheets (الطريقة الأضمن GET) ---
    const scriptURL = "https://script.google.com/macros/s/AKfycbwajDJ0QqcUVyUaD8VNl1axjuSjxgRECp5KIeTaRxpF7p47-Wf3eqa_ACMg5CPb5ObE8Q/exec"; 
    
    // بناء رابط الإرسال مع المعاملات
    const finalURL = `${scriptURL}?name=${encodeURIComponent(name)}&score=${encodeURIComponent(score + " / " + totalQuestions)}`;

    fetch(finalURL, {
        method: 'GET',
        mode: 'no-cors'
    })
    .then(() => {
        alert("تم إرسال نتيجتك وحفظها في الإكسل وتليجرام بنجاح!");
    })
    .catch(error => {
        console.error("Error:", error);
    });
});